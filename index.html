<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Studywest Widget</title>
    <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
</head>
<body>
    <div id="main">
        <label for="universityDropdown">选择大学:</label>
        <select id="universityDropdown"></select>
        
        <label for="courseDropdown">选择课程:</label>
        <select id="courseDropdown"></select>
    </div>

    <script type="text/javascript">
        // 初始化下拉框数据
        var universities = {};

        // 从外部数据源抓取数据
        async function fetchData() {
            // 请替换为你自己的数据源 URL
            const response = await fetch('YOUR_DATA_SOURCE_URL');
            const data = await response.json();

            data.forEach(row => {
                const university = row.university;
                const course = row.course;
                if (!universities[university]) {
                    universities[university] = [];
                }
                universities[university].push(course);
            });

            updateUniversityDropdown();
        }

        function updateUniversityDropdown() {
            var universityDropdown = document.getElementById('universityDropdown');
            universityDropdown.innerHTML = '<option value="">请选择大学</option>';
            Object.keys(universities).forEach(function(university) {
                var option = document.createElement('option');
                option.value = university;
                option.text = university;
                universityDropdown.appendChild(option);
            });
        }

        function updateCourseDropdown() {
            var courseDropdown = document.getElementById('courseDropdown');
            var selectedUniversity = document.getElementById('universityDropdown').value;
            courseDropdown.innerHTML = '<option value="">请选择课程</option>';
            if (universities[selectedUniversity]) {
                universities[selectedUniversity].forEach(function(course) {
                    var option = document.createElement('option');
                    option.value = course;
                    option.text = course;
                    courseDropdown.appendChild(option);
                });
            }
        }

        // 初始化时加载数据
        JFCustomWidget.subscribe("ready", function() {
            fetchData();
            document.getElementById('universityDropdown').addEventListener('change', updateCourseDropdown);
        });
    </script>
</body>
</html>
